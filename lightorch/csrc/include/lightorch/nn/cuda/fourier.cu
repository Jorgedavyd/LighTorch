// Optimized implementation of the fourier layer